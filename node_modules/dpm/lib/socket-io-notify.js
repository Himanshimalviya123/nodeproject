var watch = require('./watch');
var cl = require('console-colorjs'); 

module.exports = function(dir) {
    var io = require('socket.io').listen(4000);
    console.log('start watch file for "' + dir + '" as "localhost/" at ' + cl.bright(4000));
   

    io.sockets.on('connection', function (socket) {
        watch(dir, function(err, file) {
            socket.emit('changed',  err || file);            
        })
    });
};


